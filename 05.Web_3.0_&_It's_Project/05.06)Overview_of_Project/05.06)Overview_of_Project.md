### Small Solidity Project Idea (uses **storage / memory / calldata / modifiers**)

## **Decentralized Healthcare Treatment Registry**

### Goal

Multiple hospitals (nodes) write treatment records.
Anyone can **verify** what treatments a patient received.
Only **authorized hospitals** can add data.

---

## Core Concepts Used

* `storage` → permanent patient records
* `calldata` → cheap, read-only function inputs
* `modifier` → gatekeeper (only hospitals)
* `mapping + struct` → organized medical data
* `view` → read-only access

---

## Data Model (what to store)

```solidity
struct Treatment {
    string treatmentName;
    uint date;
    address hospital;
}

mapping(address => Treatment[]) private patientHistory;
mapping(address => bool) public hospitals;
address public admin;
```

---

## Access Control (gatekeeper)

```solidity
modifier onlyAdmin() {
    require(msg.sender == admin, "not admin");
    _;
}

modifier onlyHospital() {
    require(hospitals[msg.sender], "not authorized hospital");
    _;
}
```

---

## Constructor (network owner)

```solidity
constructor() {
    admin = msg.sender;
}
```

---

## Register hospitals (nodes)

```solidity
function addHospital(address _hospital) external onlyAdmin {
    hospitals[_hospital] = true;
}
```

---

## Add treatment (hospital node)

```solidity
function addTreatment(
    address patient,
    string calldata treatmentName
) external onlyHospital {

    patientHistory[patient].push(
        Treatment({
            treatmentName: treatmentName,
            date: block.timestamp,
            hospital: msg.sender
        })
    );
}
```

**Why `calldata`?**

* Input string
* No modification
* Cheapest gas

---

## Read patient treatments (anyone)

```solidity
function getTreatments(address patient)
    external
    view
    returns (Treatment[] memory)
{
    return patientHistory[patient];
}
```

**Why `memory`?**

* Returning data
* Cannot return storage references

---

## Where each concept is used (mapping to theory)

| Concept    | Used Where       | Reason                  |
| ---------- | ---------------- | ----------------------- |
| `storage`  | `patientHistory` | persistent medical data |
| `memory`   | return value     | temporary copy          |
| `calldata` | function input   | gas efficient           |
| `modifier` | `onlyHospital`   | gatekeeper              |
| `view`     | read function    | no gas externally       |

---

## Real-world flow

1. Admin deploys contract
2. Admin registers hospitals
3. Hospitals add treatments
4. Patient / doctor verifies history
5. Data is immutable & shared across nodes

---

## Extension ideas (easy upgrades)

* Hash treatment details instead of plain text
* Add patient consent (`onlyPatientOrHospital`)
* Add IPFS CID for reports
* Add role-based access (`doctor`, `lab`)

---

```
┌──────────────────┐
│   Admin (Owner)  │
└────────┬─────────┘
         │ deploy contract
         │
         ▼
┌──────────────────────────────┐
│ HealthcareRegistry Contract  │
│                              │
│ - admin                       │
│ - hospitals[address]          │
│ - patientHistory[address][]   │
└────────┬───────────┬─────────┘
         │           │
 addHospital()   getTreatments()
 (onlyAdmin)     (view, public)
         │           │
         ▼           ▼
┌────────────────┐   ┌─────────────────┐
│ Hospital Node  │   │ Patient / Doctor│
│ (authorized)   │   │ / Verifier      │
└───────┬────────┘   └─────────────────┘
        │
        │ addTreatment()
        │ (onlyHospital)
        │
        ▼
┌──────────────────────────────┐
│ patientHistory[patient]      │
│ ┌──────────────────────────┐ │
│ │ Treatment {              │ │
│ │  treatmentName (string)  │ │
│ │  date (timestamp)        │ │
│ │  hospital (address)      │ │
│ │ }                        │ │
│ └──────────────────────────┘ │
└──────────────────────────────┘
```

### Data flow (step-by-step, precise)

1. **Admin deploys contract**

   * `admin = msg.sender`
2. **Admin registers hospitals**

   * `hospitals[hospitalAddr] = true`
3. **Hospital adds treatment**

   * Calls `addTreatment(patient, treatmentName)`
   * Modifier `onlyHospital` checks authorization
   * Data stored in **storage** (`patientHistory`)
4. **Anyone verifies history**

   * Calls `getTreatments(patient)`
   * Returns **memory copy** (read-only, no gas externally)

### Where concepts apply

* **Gatekeeper (modifier)** → blocks unauthorized hospitals
* **storage** → permanent medical records
* **calldata** → treatment input (cheap, read-only)
* **memory** → returned data
* **view** → verification without gas
